syntoniq(version=1)
midi_instrument(instrument=23)

define_scale(scale="JI1") <<
1     c
25/24 c#     ; major third above a
9/8   d
6/5   e%
5/4   e
4/3   f
11/8  h11    ; 11th harmonic
45/32 f#     ; major third above d
3/2   g
8/5   a%
5/3   a
7/4   h7     ; 7th harmonic
16/9  b%
15/8  b
>>

use_scale(scale="JI1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g

; Transpose by note
transpose(written=c pitch_from=e part="p1")
check_pitch(note=c pitch=220*^1|4*5/4 part="p1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g

; Reverse by note
transpose(written=e pitch_from=c part="p1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g

; Absolute pitch (a tiny bit higher)
set_base_pitch(absolute=264 part="p1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g

; Relative pitch
save_pitch(var="old_e" note=e part="p1")
set_base_pitch(relative=9/8 part="p1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g

; Restore saved pitch
restore_pitch(var="old_e" note=e part="p1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g

; Transpose with octave marks. This goes up two octaves.
transpose(written=c, pitch_from=c' part="p1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g

; Save and restore with octaves. This goes back down.
save_pitch(note=c,2 var="x" part="p1")
restore_pitch(note=c var="x" part="p1")
[p1.0] 1:c
[p1.1] 1:e
[p1.2] 1:g
